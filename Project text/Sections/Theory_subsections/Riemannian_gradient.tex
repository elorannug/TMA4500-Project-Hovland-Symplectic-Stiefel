\subsection{Riemannian gradient of the Symplectic Stiefel manifold}
Another component to many optimization algorithms is the gradient. In the Euclidean setting the gradient of the cost function is a vector that points in the direction of the steepest ascent. Analogously, the Riemannian gradient points in the direction of the steepest ascent on the manifold. A useful analogy of what this means is to consider the sphere, and some cost function defining a surface on the sphere. The riemannian gradient would then point in the direction towards the closest highest point on the sphere. In this section we will state the Riemannian gradient explicitly, and prove that it satisfies necessary properties. 
\begin{proposition}
    Given \todo{add general def of R grad.?}a function $f\colon \mathrm{SpSt}(2n, 2k)\xrightarrow{}\mathbb{R}$, the \text{Riemannian gradient} with respect to $g_{p}$ is given by
    \begin{equation}\label{eq:rie_grad}
        \operatorname{grad}f(p)=\nabla f(p)p^{T}p+J_{2n}p(\nabla f(p))^{T}J_{2n}p,
    \end{equation}
    where $\nabla f(p)$ is the Euclidean gradient of a smooth extension around $p\in \mathrm{SpSt}(2n, 2k)$ in $\mathbb{R}^{2n\times2k}$ at $p$.
\end{proposition}
\begin{proof}
    We can see that this is the Riemannian gradient by the following two observations stated in \cite[p.~12]{BendokatZimmermann2021}, which we verify ourselves below.

    Firstly, gradient must be in $T_{p}\mathrm{SpSt}(2n, 2k)$, which means by \eqref{eq:spst_tangent_space} that $0=p^{+}\operatorname{grad}f(p)+(\operatorname{grad}f(p))^{+}p$. Computing this we get 
    \begin{equation*}
        \begin{split}
        &p^{\mathrm{T}}J\nabla f(p)p^{\mathrm{T}}p+p^{\mathrm{T}}JJp(\nabla f(p))^{\mathrm{T}}Jp+p^{\mathrm{T}}p(\nabla f(p))^{\mathrm{T}}Jp+p^{\mathrm{T}}J^{\mathrm{T}}\nabla f(p)p^{\mathrm{T}}J^{\mathrm{T}}Jp=0,
        % &= -p^{\mathrm{T}}J^{\mathrm{T}}\nabla f(p)p^{\mathrm{T}}J^{\mathrm{T}}Jp-p^{\mathrm{T}}p(\nabla f(p))^{\mathrm{T}}Jp+p^{\mathrm{T}}p(\nabla f(p))^{\mathrm{T}}Jp+p^{\mathrm{T}}J^{\mathrm{T}}\nabla f(p)p^{\mathrm{T}}J^{\mathrm{T}}Jp=0
        \end{split}
    \end{equation*}
    where we have used $JJ=-J^{\mathrm{T}}J=-I_{2n}$ and \eqref{eq:J_2n_properties}.
    
    Secondly, the gradient also has to satisfy $g_{p}(\operatorname{grad}f(p),X)=\operatorname{d}f_p(X)=\mathrm{tr}((\nabla f(p))^\mathrm{T}X)$ for all $X\in T_{p}\mathrm{SpSt}(2n, 2k)$:
    \begin{align*}
        g_{p}(\operatorname{grad}f(p),X)&=\mathrm{tr}\big((p^{\mathrm{T}}p (\nabla f(p))^{\mathrm{T}}+p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p)p ^{\mathrm{T}}J ^{\mathrm{T}})(I_{2n}- \tfrac{1}{2}G)X(p ^{\mathrm{T}}p)^{-1}\big),\\
        \intertext{where $G \coloneqq J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}p ^{\mathrm{T}}J$. Expanding this expression we obtain}
        &=\mathrm{tr}\big(p ^{\mathrm{T}}p(\nabla f(p)) ^{\mathrm{T}}X(p ^{\mathrm{T}}p)^{-1}\big)- \tfrac{1}{2}\mathrm{tr}\big(p ^{\mathrm{T}}p(\nabla f(p)) ^{\mathrm{T}}GX(p ^{\mathrm{T}}p)^{-1}\big)\\
        &+\mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}} \nabla f(p)p ^{\mathrm{T}}J ^{\mathrm{T}}X (p ^{\mathrm{T}}p)^{-1}\big)- \tfrac{1}{2}\mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p)p ^{\mathrm{T}}J ^{\mathrm{T}}GX(p ^{\mathrm{T}}p)^{-1}\big),\\
        \intertext{where the cancellations used the fact that the trace is invariant under circular shifts. Noting that the first term is by definition $\operatorname{d}f_{p}(X)$, and inserting the definition of $G$, the expression becomes}
        &=\operatorname{d}f_{p}(X)- \tfrac{1}{2} \mathrm{tr}\big((\nabla f(p)) ^{\mathrm{T}}J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}p ^{\mathrm{T}}JX\big)\\
        &+\mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p) p ^{\mathrm{T}}J ^{\mathrm{T}}X(p ^{\mathrm{T}}p)^{-1}\big)\\
        &- \tfrac{1}{2} \mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p)p ^{\mathrm{T}}J ^{\mathrm{T}}J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}p ^{\mathrm{T}}JX(p ^{\mathrm{T}}p)^{-1}\big).
    \end{align*}
    After using $J ^{\mathrm{T}}J ^{\mathrm{T}} = -I_{2n}$ and \eqref{eq:J_2n_properties} on the last term, we notice that we can cancel $p ^{\mathrm{T}}p(p ^{\mathrm{T}})p^{-1}$, making it equal to the second to last term. Now focusing on the second term: for the first equality we use the fact that for any matrix, $A$, $\mathrm{tr}(A)=\mathrm{tr}(A ^{\mathrm{T}})$, and for the second equality we utilize the cyclic property of the trace, and \eqref{eq:J_2n_properties},  
    \begin{align}
        \tfrac{1}{2} \mathrm{tr}\big((\nabla f(p)) ^{\mathrm{T}}J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}p ^{\mathrm{T}}JX\big)&=\tfrac{1}{2} \mathrm{tr}\big(X ^{\mathrm{T}}J ^{\mathrm{T}}p (p ^{\mathrm{T}}p)^{-1}p ^{\mathrm{T}}J \nabla f(p)\big)\nonumber\\
        &=-\tfrac{1}{2} \mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}} \nabla f(p)X ^{\mathrm{T}}J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}\big) \label{eq:proof_rie_grad_spst_property}
    \end{align}
    Inserting \eqref{eq:proof_rie_grad_spst_property} into our expression we end up with:
    \begin{equation*}
        \begin{split}
            \operatorname{d}f_{p}(X)&= \operatorname{d}f_{p}(X)+\tfrac{1}{2} \mathrm{tr}\big(p ^{\mathrm{T}}J \nabla f(p)X ^{\mathrm{T}}J ^{\mathrm{T}}p(p ^{\mathrm{T}}p)^{-1}\big)+\tfrac{1}{2}\mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p) p ^{\mathrm{T}}J ^{\mathrm{T}}X(p ^{\mathrm{T}}p)^{-1}\big),
        % g_{p}(\operatorname{grad}f(p),X)&= \operatorname{d}f_{p}(X)+\tfrac{1}{2} \mathrm{tr}\big(p ^{\mathrm{T}}J \nabla f(p)\underbrace{X ^{\mathrm{T}}J ^{\mathrm{T}}p}_{=-X ^{\mathrm{T}}Jp}(p ^{\mathrm{T}}p)^{-1}\big)\\
        % &+\tfrac{1}{2}\mathrm{tr}\big(p ^{\mathrm{T}}J ^{\mathrm{T}}\nabla f(p) \underbrace{p ^{\mathrm{T}}J ^{\mathrm{T}}X}_{=-p^ {\mathrm{T}}JX}(p ^{\mathrm{T}}p)^{-1}\big)=\operatorname{d}f_{p}(X),
        \end{split}
    \end{equation*}
    where the last two terms cancel after applying \eqref{eq:J_2n_properties}, and the tangent space condition \eqref{eq:spst_tangent_space}, $p ^{\mathrm{T}}JX=-X ^{\mathrm{T}}Jp$.
\end{proof}