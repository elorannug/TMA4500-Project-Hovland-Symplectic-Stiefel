\subsection{The Proper Symplectic Decomposition Problem}\label{sec:symplectic_decomposition}
The final experiment we will conduct is to apply GD, TR-1 and TR-2 to the problem of computing the proper symplectic decomposition of a matrix $s\in \mathbb{R}^{2n\times 2m}$ in a similar manner to Jensen and Zimmermann \cite[p.~18]{JensenZimmermann2024}. This problem is an important task in symplectic model order reduction of Hamiltonian systems. This problem can be formulated as the following optimization problem:
%
\begin{equation}
\min_{p \in \mathrm{SpSt}(2n, 2k)}f(p),\quad\text{where}\quad f(p)\coloneqq\lvert \lvert s-pp^{+}s \rvert  \rvert _{\mathrm{F}}^{2}.
\end{equation}
%
In most applications $k\ll n$. For a point $p\in \mathrm{SpSt}(2n, 2k)$ and $X\in T_{p}\mathrm{SpSt}(2n, 2k)$, Euclidean gradient and Hessian are, respectively,
%
\begin{align*}
\nabla f(p)&=-2\big((I-pp^{+})ss^{\mathrm{T}}J^{\mathrm{T}}pJ-Jss^{\mathrm{T}}(I-pp^{+})^{\mathrm{T}}pJ\big), \\
\nabla^{2}f(p)[X]&=-2(\alpha(p,X)pJ+\eta XJ-\alpha(p,X)^{\mathrm{T}}pJ-\eta ^{\mathrm{T}}XJ),
\end{align*}
%
where $\alpha(p,X)=\beta(p,X)ss^{\mathrm{T}}J$ where $\beta(p,X)=\operatorname{D}(I-pp^{+})[X]=-Xp^{+}-(Xp^{+})^{+}$, and $\eta=(I-pp^{+})SS^{\mathrm{T}}J^{\mathrm{T}}$. To construct $s$, we generate a matrix $u\in \mathrm{SpSt}(2n, 2r)$ as well as another matrix $v\in \mathbb{R}^{2r\times 2m}$, which we normalize; $v=v\cdot \lvert \lvert v \rvert \rvert_{\mathrm{F}}^{-1}$. From these two matrices we generate $s=u\cdot v$. For the optimization run we choose $n=100$, $k=10$, $r=20$, and $m=30$. The results are displayed in Figure \ref{fig:symplectic_decomposition}.

\begin{figure}
    \begin{tikzpicture}
        \begin{groupplot}[
            group style = {
                group size = 2 by 1,
                horizontal sep=1.75cm },
            width = 0.48\textwidth,
            height = 0.4\textwidth,        
            xlabel={Iteration}
        ]
        % (1,1)
        \nextgroupplot[
            title = {Convergence of $f(p)$},
            ylabel={$f(p)$},
            xmode=log,
            ymode=log]
            \addplot table [
                x=iterations, 
                y=cost_GD, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{GD}

            \addplot table [
                x=iteration_TR_hess, 
                y=cost_TR_hess, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{TR-1}

            \addplot table [
                x=iteration_TR_hess_approx, 
                y=cost_TR_hess_approx, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{TR-2}
        % (1,2)
        \nextgroupplot[
            title = {Convergence of $\lvert \lvert \operatorname{grad}f(p) \rvert \rvert_{p}$},
            ylabel={$\lvert \lvert \operatorname{grad}f(p) \rvert \rvert_{p}$},
            ymode=log,
            xmode=log]
            \addplot table [
                x=iterations, 
                y=gradient_GD, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{GD}

            \addplot table [
                x=iteration_TR_hess, 
                y=gradient_TR_hess, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{TR-1}

            \addplot table [
                x=iteration_TR_hess_approx, 
                y=gradient_TR_hess_approx, 
                col sep=comma]{../2nd_order_symplectic_decomposition_n100k10r20m30.csv};
            \addlegendentry{TR-2}
        \end{groupplot}
    \end{tikzpicture}
        \caption[Proper Symplectic Decomposition Comparison]{The proper symplectic decomposition problem attempted solved by GD, TR-1 and TR-2 on $\mathrm{SpSt}(2n, 2k)$, with $n=100$, $k=10$, $r=20$, and $m=30$. None of the algorithms converged. }\label{fig:symplectic_decomposition}
\end{figure}
It is clear from Figure \ref{fig:symplectic_decomposition} that none of the algorithms converge as expected from the theory. We observe that all three algorithms are stopped by the maximum iteration count set at $10^{3}$ iterations. In addition, all three algorithms follow the pattern of very low convergence rate. The last thing all three algorithms share, is that they all have some temporary increase in the value of $\lvert \lvert \operatorname{grad}f(p) \rvert \rvert_{p}$. This is not infeasible for TR-1 and TR-2, but quite odd for GD. Similarly to Figure \ref{fig:nearest_symplectic_matrix_2nd_order}, the values of TR-1 and TR-2 have, for both $f(p)$ and $\lvert \lvert \operatorname{grad}f(p) \rvert \rvert_{p}$, almost the same function value for all steps. 